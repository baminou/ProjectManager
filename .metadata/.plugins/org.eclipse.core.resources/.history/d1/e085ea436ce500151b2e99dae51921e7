package controller;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.File;
import java.io.IOException;
import java.rmi.NotBoundException;
import java.rmi.RemoteException;
import java.util.Calendar;

import javax.swing.JOptionPane;
import javax.swing.JPanel;

import jxl.read.biff.BiffException;
import jxl.write.WriteException;
import jxl.write.biff.RowsExceededException;

import org.apache.commons.lang3.text.WordUtils;

import app.Project;
import view.GeneralInfoView;
import epi.GeneralInfoObserver;
import epi.ServerInterface;

public interface SpecificProjectController extends GeneralInfoObserver {
	
	public void generate();
	
	//public abstract void generate() throws IOException, RowsExceededException, WriteException, BiffException, NotBoundException, app.ConventionException;

	public abstract JPanel get_view();
	
	public void send_to_server();
	
	public void create_folder(String folder_name){
		try {
			ServerInterface.getInstance().get_stub().createScratchDirectory(folder_name);
		} catch (RemoteException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (NotBoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	public String get_folder_name(String title, String species, String description, Project project_name, String parent_path){
		Calendar cal = Calendar.getInstance();
		String year = String.valueOf(cal.get(Calendar.YEAR));
		String month = String.format("%02d",cal.get(Calendar.MONTH)+1);
		String day = String.format("%02d",cal.get(Calendar.DAY_OF_MONTH));
		
		String modified_title = WordUtils.capitalizeFully(title).replaceAll("\\s+", "");
		String modified_description = WordUtils.capitalizeFully(description).replaceAll("\\s", "");
		return parent_path+"/"+year+month+day+"_"+project_name.get_title()+"_"+modified_title+"_"+species+"_"+modified_description;
	}
}
