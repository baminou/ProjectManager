package controller;

import javax.swing.JOptionPane;
import javax.swing.tree.DefaultTreeModel;
import javax.swing.tree.TreeNode;

import app.Project;
import app.ProjectConventionException;
import epi.ServerInterface;
import view.SelectExistingProjectView;

/**
 * Select an existing project on the server
 * @author briceaminou
 *
 */
public class SelectExistingProjectController {
	
	private SelectExistingProjectView _view;
	
	public SelectExistingProjectController(){
		_view = new SelectExistingProjectView();
	}
	
	public Project show() throws ProjectConventionException{
		DefaultTreeModel model = (DefaultTreeModel)_view.get_tree().getModel();
		model.setRoot((TreeNode)ServerInterface.getInstance().get_stub().getScratchTreeStructure().getModel().getRoot());
		
		int result = JOptionPane.showConfirmDialog(null, _view,"Sync folder",JOptionPane.OK_CANCEL_OPTION,JOptionPane.PLAIN_MESSAGE);
		if(result==JOptionPane.OK_OPTION){
			Project project = new Project(_view.get_tree().getSelectionPath().getLastPathComponent().toString());
			return project;
		}
		throw new ProjectConventionException("No folder selected.");
	}
	public SelectExistingProjectView get_view() {
		return _view;
	}

	public void set_view(SelectExistingProjectView _view) {
		this._view = _view;
	}

}
